{
    "app-id": "fr.natron.Natron",
    "runtime": "org.freedesktop.Sdk",
    "runtime-version": "19.08",
    "sdk": "org.freedesktop.Sdk",
    "command": "Natron",
    "rename-icon": "natronIcon256_linux",
    "finish-args": [
            "--share=ipc",
            "--socket=x11",
            "--socket=pulseaudio",
            "--filesystem=host",
            "--device=dri"
    ],
    "modules": [
            "shared-modules/glew/glew.json",
            "shared-modules/glu/glu-9.json",
            "shared-modules/python2.7/python-2.7.json",
    {
            "name": "qt4",
            "config-opts": [
                    "-no-multimedia",
                    "-no-gif",
                    "-qt-libpng",
                    "-no-libmng",
                    "-no-libtiff",
                    "-no-libjpeg",
                    "-no-static",
                    "-shared",
                    "-openssl-linked",
                    "-confirm-license",
                    "-release",
                    "-opensource",
                    "-nomake", "demos",
                    "-nomake", "docs",
                    "-nomake", "examples",
                    "-no-gtkstyle",
                    "-no-webkit",
                    "-no-avx",
                    "-no-openvg",
                    "-no-phonon",
                    "-no-phonon-backend",
                    "-xmlpatterns"
    ],
    "build-options": {
        "env": {
            "CXXFLAGS": "-std=gnu++98 -O2",
            "LD_LIBRARY_PATH": "/run/build/qt4/lib/"
        }
    },
    "sources": [
        {
            "type": "archive",
            "url": "https://download.qt.io/archive/qt/4.8/4.8.7/qt-everywhere-opensource-src-4.8.7.tar.gz",
            "sha256": "e2882295097e47fe089f8ac741a95fef47e0a73a3f3cdf21b56990638f626ea0"
        },
        {
            "type": "patch",
            "path": "patches/Qt4-enable-building-with-C-11-and-C-14.patch"
        },
        {
            "type": "patch",
            "path": "patches/Qt4-better-invalid-fonttable-handling.diff",
            "strip-components": 0
        },
        {
            "type": "patch",
            "path": "patches/Qt4-qsettings-null.diff",
            "strip-components": 0
        },
        {
            "type": "patch",
            "path": "patches/Qt4-gcc6.patch"
        },
        {
            "type": "patch",
            "path": "patches/Qt4-kde-fix.diff",
            "strip-components": 0
        },
        {
            "type": "patch",
            "path": "patches/Qt4-pcre.patch",
            "strip-components": 0
        },
        {
            "type": "patch",
            "path": "patches/Qt4-selection-flags-static_cast.patch"
        },
        {
            "type": "patch",
            "path": "patches/Qt4-src_corelib_io_qprocess_unix.cpp.diff",
            "strip-components": 0
        },
        {
            "type": "patch",
            "path":"patches/fix-build-icu59.patch"
        },
        {
            "type": "patch",
            "path": "patches/qt4-aarch64.patch"
        },
        {
             "type": "patch",
             "path": "patches/qt4-disable-sslv3.patch"
        },
        {
            "type": "patch",
            "path": "patches/gcc9-qforeach.patch"
        },
        {
            "type": "patch",
            "path": "patches/qt4-openssl-1.1.patch"
        }
    ],
    "cleanup": [
            "/bin",
            "/include",
            "/lib/*.a",
            "/lib/*.la",
            "/lib/*.prl",
            "/lib/pkgconfig",
            "/lib/qt4/mkspecs",
            "/lib/qt4/q3porting.xml",
            "/mkspecs",
            "/phrasebooks",
            "q3porting.xml"
        ]
    },
    {
            "name": "boost",
            "buildsystem": "simple",
            "build-commands": [
                "./bootstrap.sh --prefix=/app --with-libraries=date_time,filesystem,iostreams,python,serialization,locale,regex,system,thread",
                "./b2 --build-type=minimal link=shared",
                "./b2 --build-type=minimal link=shared install"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://sourceforge.net/projects/boost/files/boost/1.73.0/boost_1_73_0.tar.bz2",
                    "sha256": "4eb3b8d442b426dc35346235c8733b5ae35ba431690e38c6a8263dce9fcbb402"
                }
            ],
            "cleanup": [
                "/include"
            ]
        },
        {
            "name": "tinyxml",
            "buildsystem": "cmake-ninja",
            "config-opts": [
                "-DCMAKE_BUILD_TYPE=Release"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://sourceforge.net/projects/tinyxml/files/tinyxml/2.6.2/tinyxml_2_6_2.tar.gz",
                    "sha256": "15bdfdcec58a7da30adc87ac2b078e4417dbe5392f3afb719f9ba6d062645593"
                },
                {
                    "type": "patch",
                    "path": "patches/tinyxml_CMakeLists.patch"
                }
            ],
            "cleanup": [
                "/include"
            ]
        },
        {
            "name": "yaml-cpp",
            "buildsystem": "cmake-ninja",
            "config-opts": [
                "-DCMAKE_BUILD_TYPE=Release",
                "-DCMAKE_POSITION_INDEPENDENT_CODE=ON"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/jbeder/yaml-cpp/archive/yaml-cpp-0.6.2.tar.gz",
                    "sha256": "e4d8560e163c3d875fd5d9e5542b5fd5bec810febdcba61481fe5fc4e6b1fd05"
                }
            ],
            "cleanup": [
                "/include"
            ]
        },
        { 
            "name": "opencolorio",
            "buildsystem": "cmake-ninja",
            "config-opts": [
                "-DCMAKE_BUILD_TYPE=Release",
                "-DOCIO_BUILD_JNIGLUE=OFF",
                "-DOCIO_STATIC_JNIGLUE=OFF",
                "-DOCIO_BUILD_TRUELIGHT=OFF",
                "-DUSE_EXTERNAL_LCMS=ON",
                "-DUSE_EXTERNAL_TINYXML=ON",
                "-DUSE_EXTERNAL_YAML=ON",
                "-DOCIO_USE_BOOST_PTR=ON",
                "-DOCIO_BUILD_NUKE=OFF",
                "-DOCIO_BUILD_SHARED=ON",
                "-DOCIO_BUILD_APPS=OFF",
                "-DOCIO_BUILD_DOCS=OFF",
                "-DOCIO_BUILD_STATIC=OFF",
                "-DOCIO_BUILD_TESTS=OFF"
                    ],
            "builddir": true,
            "build-options": {
                "arch": {
                    "arm": {
                        "config-opts": [
                            "-DOCIO_USE_SSE:BOOL=OFF"
                        ]
                    },
                    "aarch64": {
                        "config-opts": [
                            "-DOCIO_USE_SSE:BOOL=OFF"
                        ]
                    }
                }
            },
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/imageworks/OpenColorIO/archive/v1.1.1.tar.gz",
                    "sha256": "c9b5b9def907e1dafb29e37336b702fff22cc6306d445a13b1621b8a754c14c8"
                },
                {
                    "type": "shell",
                    "commands": [
                        "find . -name CMakeLists.txt -exec sed -e s/-Werror// -i {} ';'"
                    ]
                }
            ],
            "cleanup": [
                "/include",
                "/cmake",
                "/lib/pkgconfig",
                "/share",
                "OpenColorIOConfig.cmake"
            ]
        },
        {
            "name": "shiboken",
            "buildsystem": "cmake-ninja",
            "builddir": true,
            "config-opts": [
                "-DCMAKE_SKIP_RPATH=true",
                "-DCMAKE_BUILD_TYPE=Release",
                "-DBUILD_TESTS=OFF"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/pyside/Shiboken/archive/1.2.4.tar.gz",
                    "sha256": "1536f73a3353296d97a25e24f9554edf3e6a48126886f8d21282c3645ecb96a4"
                },
                {
                    "type": "patch",
                    "path": "patches/shiboken_gcc6.patch"
                },
                {
                    "type": "patch",
                    "path": "patches/shiboken_memleak-instead-crash.patch"
                }
            ],
            "cleanup": [
                "/bin",
                "/include"
            ]
        },
        {
            "name": "pyside",
            "buildsystem": "cmake-ninja",
            "config-opts": [
                "-DBUILD_TESTS=OFF"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/pyside/PySide/archive/1.2.4.tar.gz",
                    "sha256": "90f2d736e2192ac69e5a2ac798fce2b5f7bf179269daa2ec262986d488c3b0f7"
                }
            ],
            "cleanup": [
                "/include"
            ]
        },
        {
            "name": "ilmbase",
            "config-opts": [
                "--enable-shared",
                "--disable-static"
            ],
            "build-options": {
                "cxxflags": "-std=c++14",
                "env": {
                    "LDFLAGS": "-lpthread"
                }
            },
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/openexr/openexr/releases/download/v2.3.0/ilmbase-2.3.0.tar.gz",
                    "sha256": "456978d1a978a5f823c7c675f3f36b0ae14dba36638aeaa3c4b0e784f12a3862"
                },
                {
                    "type": "shell",
                    "commands": [
                        "rm config.guess configure"
                    ]
                }
            ],
            "cleanup": [
                "/include/OpenEXR",
                "/lib/libHalf.la",
                "/lib/libIex*.la",
                "/lib/libIlm*.la",
                "/lib/libImath*.la",
                "/lib/pkgconfig/IlmBase.pc"
            ]
        },
        {
            "name": "openexr",
            "config-opts": [
                "--enable-shared",
                "--disable-static"
            ],
            "build-options": {
                "cxxflags": "-std=c++14"
            },
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/openexr/openexr/releases/download/v2.3.0/openexr-2.3.0.tar.gz",
                    "sha256": "fd6cb3a87f8c1a233be17b94c74799e6241d50fc5efd4df75c7a4b9cf4e25ea6"
                },
                {
                    "type": "patch",
                    "path": "patches/openexr-no-docs.patch"
                },
                {
                    "type": "shell",
                    "commands": [
                        "rm config.guess configure"
                    ]
                }
            ],
            "cleanup": [
                "/bin",
                "/include",
                "/lib/*.la",
                "/lib/pkgconfig",
                "/share/aclocal"
            ]
        },
        {
            "name": "libraw",
            "config-opts": [
                "--disable-static",
                "--enable-jasper",
                "--enable-jpeg",
                "--enable-demosaic-pack-gpl2"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://www.libraw.org/data/LibRaw-0.19.2.tar.gz",
                    "sha256": "400d47969292291d297873a06fb0535ccce70728117463927ddd9452aa849644"
                },
                {
                    "type": "archive",
                    "url": "https://www.libraw.org/data/LibRaw-demosaic-pack-GPL2-0.18.8.tar.gz",
                    "sha256": "0b24bcf7bbb5d13fde58bb071f94dc9354be09bc44b2bba0698493065e99f8da",
                    "dest": "./LibRaw-demosaic-pack-GPL2"
                }
            ],
            "cleanup": [
                "/bin",
                "/share/doc",
                "/include",
                "/lib/*.la"
            ]
        },
        {
            "name" : "libheif",
            "config-opts": [ "--disable-gdk-pixbuf" ],
            "cleanup": [ "/bin" ],
            "modules": [
                {
                    "name": "libde265",
                    "config-opts": [ "--disable-sherlock265" ],
                    "cleanup": [ "/bin" ],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://github.com/strukturag/libde265/releases/download/v1.0.5/libde265-1.0.5.tar.gz",
                            "sha256": "e3f277d8903408615a5cc34718b391b83c97c646faea4f41da93bac5ee08a87f"
                        }
                    ]
                }
            ],
            "sources" : [
                {
                    "url" : "https://github.com/strukturag/libheif/releases/download/v1.6.2/libheif-1.6.2.tar.gz",
                    "sha256" : "bb229e855621deb374f61bee95c4642f60c2a2496bded35df3d3c42cc6d8eefc",
                    "type" : "archive"
                }
            ]
        },
        {
            "name": "fmt",
            "buildsystem": "cmake-ninja",
            "builddir": true,
            "config-opts": [
                "-DCMAKE_BUILD_TYPE=Release"
            ],
            "cleanup": [
                "/include",
                "*.a"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/fmtlib/fmt/archive/5.2.1.tar.gz",
                    "sha256": "3c812a18e9f72a88631ab4732a97ce9ef5bcbefb3235e9fd465f059ba204359b"
                }
            ]
        },
        {
            "name": "robin-map",
            "buildsystem": "cmake-ninja",
            "builddir": true,
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/Tessil/robin-map/archive/v0.6.2.tar.gz",
                    "sha256": "c08ec4b1bf1c85eb0d6432244a6a89862229da1cb834f3f90fba8dc35d8c8ef1"
                }
            ],
            "cleanup": [
                "/include"
            ]
        },
        {
            "name": "openimageio",
            "buildsystem": "cmake-ninja",
            "builddir": true,
            "config-opts": [
                "-DCMAKE_BUILD_TYPE=Release",
                "-DUSE_OPENCV:BOOL=FALSE",
                "-DUSE_OPENSSL:BOOL=FALSE",
                "-DUSE_QT5:BOOL=FALSE",
                "-DUSE_OPENGL:BOOL=FALSE",
                "-DUSE_HEIF:BOOL=TRUE",
                "-DUSE_OPENJPEG:BOOL=TRUE",
                "-DUSE_PYTHON:BOOL=FALSE",
                "-DUSE_FIELD3D:BOOL=FALSE",
                "-DOIIO_BUILD_TESTS=0",
                "-DOIIO_BUILD_TOOLS=1",
                "-DSTOP_ON_WARNING:BOOL=FALSE",
                "-DUSE_GIF:BOOL=TRUE",
                "-DUSE_FREETYPE:BOOL=TRUE",
                "-DUSE_FFMPEG:BOOL=FALSE",
                "-DLINKSTATIC=0",
                "-DOpenJpeg_ROOT=/app/",
                "-DUSE_LIBRAW:BOOL=TRUE",
                "-DLIBRAW_PATH=/app/lib/libraw",
                "-DCMAKE_LIBRARY_PATH=/app/lib"
            ],
            "modules": [
                "shared-modules/openjpeg/openjpeg.json"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/OpenImageIO/oiio/archive/Release-2.1.16.0.tar.gz",
                    "sha256": "f44e3b3cffe9a8f47395da1ae59e972ecb26adf65f17581e6a489fdcce0cb116"
                }
            ],
            "cleanup": [
                "/bin",
                "/include"
            ]
        },
        {
            "name": "x264",
            "config-opts": [
                "--enable-shared",
                "--disable-cli"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "http://ftp.videolan.org/pub/x264/snapshots/x264-snapshot-20190730-2245-stable.tar.bz2",
                    "sha256": "954371ae1ce18bee2227a88f860afead2da1bc18522c646b5dc18e74d6452288"
                }
            ],
            "cleanup": [
                "/include",
                "/lib/pkgconfig"
            ]
        },
        {
            "name": "x265_32",
            "only-arches": ["i386"],
            "buildsystem": "simple",
            "build-commands": [
                "mkdir source/build-8 source/build-10 source/build-12",
                "cd source/build-12 && cmake .. -DCMAKE_INSTALL_PREFIX=${FLATPAK_DEST} -DHIGH_BIT_DEPTH='TRUE' -DMAIN12='TRUE' -DEXPORT_C_API='FALSE' -DENABLE_CLI='FALSE' -DENABLE_SHARED='FALSE'",
                "cd source/build-12 && make",
                "cd source/build-10 && cmake .. -DCMAKE_INSTALL_PREFIX=${FLATPAK_DEST} -DHIGH_BIT_DEPTH='TRUE' -DEXPORT_C_API='FALSE' -DENABLE_CLI='FALSE' -DENABLE_SHARED='FALSE'",
                "cd source/build-10 && make",
                "ln -s ../build-10/libx265.a source/build-8/libx265_main10.a",
                "ln -s ../build-12/libx265.a source/build-8/libx265_main12.a",
                "cd source/build-8 && cmake .. -DCMAKE_INSTALL_PREFIX=${FLATPAK_DEST} -DENABLE_SHARED='TRUE'",
                "cd source/build-8 && make",
                "cd source/build-8 && make install"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://bitbucket.org/multicoreware/x265/downloads/x265_3.2.1.tar.gz",
                    "sha256": "fb9badcf92364fd3567f8b5aa0e5e952aeea7a39a2b864387cec31e3b58cbbcc"
                }
            ],
            "cleanup": [
                "/include"
            ]
        },
        {
            "name": "x265_64",
            "skip-arches": ["i386"],
            "buildsystem": "simple",
            "build-commands": [
                "mkdir source/build-8 source/build-10 source/build-12",
                "cd source/build-12 && cmake .. -DCMAKE_INSTALL_PREFIX=${FLATPAK_DEST} -DHIGH_BIT_DEPTH='TRUE' -DMAIN12='TRUE' -DEXPORT_C_API='FALSE' -DENABLE_CLI='FALSE' -DENABLE_SHARED='FALSE'",
                "cd source/build-12 && make",
                "cd source/build-10 && cmake .. -DCMAKE_INSTALL_PREFIX=${FLATPAK_DEST} -DHIGH_BIT_DEPTH='TRUE' -DEXPORT_C_API='FALSE' -DENABLE_CLI='FALSE' -DENABLE_SHARED='FALSE'",
                "cd source/build-10 && make",
                "ln -s ../build-10/libx265.a source/build-8/libx265_main10.a",
                "ln -s ../build-12/libx265.a source/build-8/libx265_main12.a",
                "cd source/build-8 && cmake .. -DCMAKE_INSTALL_PREFIX=${FLATPAK_DEST} -DENABLE_SHARED='TRUE'",
                "cd source/build-8 && make",
                "cd source/build-8 && make install"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://bitbucket.org/multicoreware/x265/downloads/x265_3.2.1.tar.gz",
                    "sha256": "fb9badcf92364fd3567f8b5aa0e5e952aeea7a39a2b864387cec31e3b58cbbcc"
                }
            ],
            "cleanup": [
                "/include"
            ]
        },
        {
            "name": "libass",
            "config-opts": [
                "--disable-static",
                "--enable-shared"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/libass/libass/releases/download/0.14.0/libass-0.14.0.tar.xz",
                    "sha256": "881f2382af48aead75b7a0e02e65d88c5ebd369fe46bc77d9270a94aa8fd38a2"
                }
            ],
            "cleanup": [
                "/include"
            ]
        },
        {
            "name": "libbluray",
            "config-opts": [
                "--disable-static",
                "--enable-shared",
                "--disable-bdjava",
                "--disable-bdjava-jar"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "ftp://ftp.videolan.org/pub/videolan/libbluray/1.1.2/libbluray-1.1.2.tar.bz2",
                    "sha256": "a3dd452239b100dc9da0d01b30e1692693e2a332a7d29917bf84bb10ea7c0b42"
                }
            ],
            "cleanup": [
                "/include"
            ]
        },
        {
            "name": "libmodplug",
            "config-opts": [
                "--enable-shared",
                "--disable-static"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://netcologne.dl.sourceforge.net/project/modplug-xmms/libmodplug/0.8.9.0/libmodplug-0.8.9.0.tar.gz",
                    "sha256": "457ca5a6c179656d66c01505c0d95fafaead4329b9dbaa0f997d00a3508ad9de"
                }
            ],
            "cleanup": [
                "/include"
            ]
        },
        {
            "name": "libsnappy",
            "buildsystem": "cmake-ninja",
            "config-opts": [
                "-DBUILD_SHARED_LIBS=ON",
                "-DSNAPPY_BUILD_TESTS=OFF",
                "-DCMAKE_BUILD_TYPE=Release"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/google/snappy/archive/1.1.7.tar.gz",
                    "sha256": "3dfa02e873ff51a11ee02b9ca391807f0c8ea0529a4924afa645fbf97163f9d4"
                }
            ],
            "cleanup": [
                "/include"
            ]
        },
        {
            "name": "libsoxr",
            "buildsystem": "cmake-ninja",
            "config-opts": [
                "-DBUILD_TESTS=no",
                "-DCMAKE_BUILD_TYPE=Release"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://netcologne.dl.sourceforge.net/project/soxr/soxr-0.1.3-Source.tar.xz",
                    "sha256": "b111c15fdc8c029989330ff559184198c161100a59312f5dc19ddeb9b5a15889"
                }
            ],
            "cleanup": [
                "/include"
            ]
        },
        {
            "name": "xvid",
            "subdir": "build/generic",
            "config-opts": [
                "--enable-shared",
                "--enable-static"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://downloads.xvid.com/downloads/xvidcore-1.3.5.tar.gz",
                    "sha256": "165ba6a2a447a8375f7b06db5a3c91810181f2898166e7c8137401d7fc894cf0"
                }
            ],
            "cleanup": [
                "/include"
            ]
        },
        {
            "name": "ffmpeg",
            "config-opts": [
                "--enable-x86asm",
                "--enable-swscale",
                "--enable-avfilter",
                "--enable-avresample",
                "--enable-libmp3lame",
                "--enable-libvorbis",
                "--enable-libopus",
                "--enable-librsvg",
                "--enable-libtheora",
                "--enable-libopenh264",
                "--enable-libopenjpeg",
                "--enable-libsnappy",
                "--enable-libmodplug",
                "--enable-libvpx",
                "--enable-libsoxr",
                "--enable-libspeex",
                "--enable-libass",
                "--enable-libbluray",
                "--enable-lzma",
                "--enable-gnutls",
                "--enable-fontconfig",
                "--enable-libfreetype",
                "--enable-libfribidi",
                "--disable-libxcb",
                "--disable-libxcb-shm",
                "--disable-libxcb-xfixes",
                "--disable-indev=jack",
                "--disable-outdev=xv",
                "--disable-xlib",
                
                "--enable-gpl",
                "--enable-libx264",
                "--enable-libx265",
                "--enable-libxvid",
                "--enable-version3",
                
                "--enable-shared",
                "--disable-static"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://www.ffmpeg.org/releases/ffmpeg-4.2.3.tar.xz",
                    "sha256": "9df6c90aed1337634c1fb026fb01c154c29c82a64ea71291ff2da9aacb9aad31"
                }
            ],
            "cleanup": [
                "/include",
                "/lib/pkgconfig",
                "/share/ffmpeg"
            ]
        },
        {
            "name": "gpac",
            "config-opts": [
                "--disable-shared",
                "--enable-static",
                "--disable-doc",
                "--extra-cflags=-fPIC"
            ],
            "make-install-args": [
                "install-lib"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/gpac/gpac.git"
                }
            ],
            "cleanup": [
                "*"
            ]
        },
        {
            "name": "sip",
            "buildsystem": "simple",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://sourceforge.net/projects/pyqt/files/sip/sip-4.19.8/sip-4.19.8.tar.gz",
                    "sha256": "7eaf7a2ea7d4d38a56dd6d2506574464bddf7cf284c960801679942377c297bc"
                }
            ],
            "build-commands": [
                "python ./configure.py -b /app/bin -d /app/lib/python2.7/site-packages -e /app/include",
                "make",
                "make install"
            ],
            "cleanup": [
                "/bin",
                "/include"
            ]
        },
        {
            "name": "seexpr",
            "buildsystem": "cmake-ninja",
            "config-opts": [
                "-DCMAKE_BUILD_TYPE=release",
                "-DCMAKE_INSTALL_LIBDIR=lib"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/wdas/SeExpr/archive/v1-2.11.tar.gz",
                    "sha256": "b1395e1e87bdc75b6abc65ab8c4894b1e04ddb60c6eef277607bb6d44b31a6c2"
                },
                {
                    "type": "patch",
                    "path": "patches/seexpr-nodemos-notests.patch"
                },
                {
                    "type": "patch",
                    "path": "patches/seexpr-fix-inline-error.patch"
                },
                {
                    "type": "patch",
                    "path": "patches/seexpr-fix-cxxflags.patch"
                }
            ],
            "cleanup": [
                "src/SeExprEditor/generated/",
                "src/SeExpr/generated/",
                "/include",
                "/lib/*.a"
            ]
        },
        {
            "name": "openfx-io",
            "buildsystem": "simple",
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/NatronGitHub/openfx-io.git",
                    "tag": "Natron-2.3.15"
                },
                {
                    "type": "patch",
                    "path": "patches/openfx-io-plugins-path.diff"
                }
            ],
            "build-commands": [
                "make CONFIG=release PREFIX-=/app",
                "make install CONFIG=release DESTDIR=/app"
            ],
            "cleanup": [
                "openfx/Documentation",
                "openfx/Examples",
                "openfx/website",
                "openfx/scripts",
                "openfx/Guide",
                "openfx/HostSupport/expat-2.2.1",
                "openfx/HostSupport/examples",
                "openfx/Support/PropTester"
            ]
        },
        {
            "name": "openfx-misc",
            "buildsystem": "simple",
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/devernay/openfx-misc.git",
                    "tag": "Natron-2.3.15",
                    "commit": "80c3f6f249f4aa59d07f88c546260a02c7a6af85"
                },
                {
                    "type": "patch",
                    "path": "patches/openfx-misc-plugins-path.diff"
                },
                {
                    "type": "patch",
                    "path": "patches/openfx-misc_disable_curl.patch"
                },
                {
                    "type": "archive",
                    "url": "https://github.com/dtschump/CImg/archive/v.2.8.4.tar.gz",
                    "sha256": "ff8b6a571686daa17a948ca03eb3494e647107417b8a7021a2dfd2c48557bef5",
                    "dest": "./CImg-v.2.8.4"
                },
                {
                    "type": "shell",
                    "commands": [
                        "cp ./CImg-v.2.8.4/CImg.h ./CImg",
                        "cp ./CImg-v.2.8.4/plugins/inpaint.h ./CImg/Inpaint",
                        "patch -p0 -dCImg < CImg/Inpaint/inpaint.h.patch"
                    ]
                }
            ],
            "build-commands": [
                "make CONFIG=release PREFIX=/app",
                "make install CONFIG=release DESTDIR=/app"
            ],
            "cleanup": [
                "openfx/Documentation",
                "openfx/Examples",
                "openfx/website",
                "openfx/scripts",
                "openfx/Guide",
                "openfx/HostSupport/expat-2.2.1",
                "openfx/HostSupport/examples",
                "openfx/Support/PropTester"
            ]
        },
        {
            "name": "openfx-arena",
            "buildsystem": "simple",
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/NatronGitHub/openfx-arena.git",
                    "tag": "Natron-2.3.15",
                    "commit": "26b0b637e1087c23684935f67306e7f8a74a6090"
                },
                {
                    "type": "patch",
                    "path": "patches/openfx-arena-plugins-path.patch"
                }
            ],
            "build-commands": [
                "make CONFIG=release PREFIX=/app",
                "make install CONFIG=release DESTDIR=/app"
            ],
            "modules": [
                {
                    "name": "cppunit",
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://dev-www.libreoffice.org/src/cppunit/cppunit-1.13.2.tar.gz",
                            "sha256": "3f47d246e3346f2ba4d7c9e882db3ad9ebd3fcbd2e8b732f946e0e3eeb9f429f"
                        }
                    ]
                },
                {
                    "name": "librevenge",
                    "config-opts": [
                        "--disable-werror",
                        "--disable-docs"
                    ],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://sourceforge.net/projects/libwpd/files/librevenge/librevenge-0.0.4/librevenge-0.0.4.tar.xz",
                            "sha256": "933f0729f04267cc354b9a02bc3e9afefa5512a3bdd0b45f159ee14a3e3347b2"
                        }
                    ],
                    "cleanup": [
                        "/bin",
                        "/include",
                        "/lib/*.la"
                    ]
                },
                {
                    "name": "libcdr",
                    "config-opts": [
                        "--disable-werror",
                        "--disable-docs"
                    ],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://dev-www.libreoffice.org/src/libcdr/libcdr-0.1.4.tar.bz2",
                            "sha256": "f3a3ebebebb32b9686dfe7f9df296ac5ae02ea610f3d7d5221b957bb14fc0ad3"
                        }
                    ],
                    "cleanup": [
                        "/bin",
                        "/lib/*.la",
                        "/include"
                    ]
                },
                {
                    "name": "libzip",
                    "buildsystem": "cmake-ninja",
                    "config-opts": [
                        "-DCMAKE_BUILD_TYPE=Release"
                    ],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://libzip.org/download/libzip-1.5.1.tar.xz",
                            "sha256": "04ea35b6956c7b3453f1ed3f3fe40e3ddae1f43931089124579e8384e79ed372"
                        }
                    ],
                    "cleanup": [
                        "/bin",
                        "/include"
                    ]
                },
                {
                    "name": "poppler-glib",
                    "buildsystem": "cmake-ninja",
                    "config-opts": [
                        "-DENABLE_LIBCURL=OFF",
                        "-DNSS3_FOUND=OFF",
                        "-DENABLE_NSS3=OFF",
                        "-DENABLE_QT5=OFF",
                        "-DENABLE_QT4=OFF",
                        "-DENABLE_GTK_DOC=OFF",
                        "-DCMAKE_BUILD_TYPE=Release",
                        "-DENABLE_XPDF_HEADERS=ON"
                    ],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://poppler.freedesktop.org/poppler-0.64.0.tar.xz",
                            "sha256": "b21df92ca99f78067785cf2dc8e06deb04726b62389c0ee1f5d8b103c77f64b1"
                        }
                    ],
                    "cleanup": [
                        "/bin",
                        "/include"
                    ]
                },
                {
                    "name": "cairo",
                    "config-opts": [
                        "--with-libpng=yes",
                        "--enable-static",
                        "--enable-tee"
                    ],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://www.cairographics.org/releases/cairo-1.14.12.tar.xz",
                            "sha256": "8c90f00c500b2299c0a323dd9beead2a00353752b2092ead558139bd67f7bf16"
                        }
                    ],
                    "cleanup": [
                        "/bin",
                        "/include",
                        "/lib/*.la"
                    ]
                },
                {
                     "name": "gdk-pixbuf",
                     "buildsystem": "autotools",
                     "config-opts": [
                         "--disable-docs",
                         "--disable-static",
                         "--enable-shared",
                         "--without-libtiff"
                    ],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "http://ftp.acc.umu.se/pub/gnome/sources/gdk-pixbuf/2.36/gdk-pixbuf-2.36.12.tar.xz",
                            "sha256": "fff85cf48223ab60e3c3c8318e2087131b590fd6f1737e42cb3759a3b427a334"
                        }
                    ],
                    "cleanup": [
                         "/bin",
                         "/include"
                    ]
                },
                {
                    "name": "librsvg",
                    "config-opts": [
                        "--disable-docs",
                        "--disable-static",
                        "--enable-shared",
                        "--disable-introspection",
                        "--disable-vala",
                        "--disable-pixbuf-loader"
                    ],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://download.gnome.org/sources/librsvg/2.40/librsvg-2.40.20.tar.xz",
                            "sha256": "cff4dd3c3b78bfe99d8fcfad3b8ba1eee3289a0823c0e118d78106be6b84c92b"
                        }
                    ],
                    "cleanup": [
                         "/bin",
                         "/include"
                    ]
                },
                {
                    "name": "imagemagic",
                    "config-opts": [
                        "--with-magick-plus-plus=yes",
                        "--with-quantum-depth=32",
                        "--without-dps",
                        "--without-djvu",
                        "--without-fftw",
                        "--without-fpx",
                        "--without-gslib",
                        "--without-gvc",
                        "--without-jbig",
                        "--without-jpeg",
                        "--with-lcms",
                        "--without-openjp2",
                        "--without-lqr",
                        "--without-lzma",
                        "--without-openexr",
                        "--with-pango",
                        "--with-png",
                        "--with-rsvg",
                        "--without-tiff",
                        "--without-webp",
                        "--with-xml",
                        "--with-zlib",
                        "--without-bzlib",
                        "--disable-static",
                        "--enable-hdri",
                        "--enable-openmp",
                        "--with-freetype",
                        "--with-fontconfig",
                        "--without-modules",
                        "--without-x"
                    ],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://www.imagemagick.org/download/releases/ImageMagick-7.0.10-17.tar.xz",
                            "sha256": "82a304c0527d372d8a8929706165702eebfaadc88762f29ce19168b5bd6bbe1e"
                        }
                    ],
                    "cleanup": [
                        "/bin",
                        "/include",
                        "/lib/*.la"
                    ]
                }
            ]
        },
        {
            "name": "openfx-gmic",
            "buildsystem": "simple",
            "build-options": {
                "env": {
                    "CXXFLAGS": "--param ggc-min-expand=20 --param ggc-min-heapsize=32768"
                }
            },
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/NatronGitHub/openfx-gmic.git",
                    "tag": "Natron-2.3.15",
                    "commit": "8805f494b1dbb106b51e128cbf7ee295462591ac"
                },
                {
                    "type": "file",
                    "url": "http://gmic.eu/files/source/gmic_2.8.4.tar.gz",
                    "sha256": "b2a279bdf981595b30d8d7828fabf9a620cde06eae8db345a8cddf2160c25379",
                    "dest": "./"
                },
                {
                    "type": "git",
                    "url": "https://github.com/dtschump/gmic-community.git",
                    "commit": "bb592b20e2e25f8786dbfb8ac05fd1c5f2e811d6",
                    "dest": "./gmic-community"
                },
                {
                    "type": "shell",
                    "commands": [
                        "cp ./gmic-community/libcgmic/gmic_libc.h ./",
                        "cp ./gmic-community/libcgmic/gmic_stdlib_gmic.h ./",
                        "cp ./gmic-community/libcgmic/gmic_libc.cpp ./"
                    ]
                },
                 {
                    "type": "patch",
                    "path": "patches/openfx-gmic_plugin_path.patch"
                }
            ],
            "build-commands": [
                "make -j${MKJOBS} OPENMP=1 CONFIG=release PREFIX=/app",
                "make install CONFIG=release DESTDIR=/app"
            ],
            "modules": [
                {
                    "name": "fftw3",
                    "config-opts": [
                        "--enable-threads",
                        "--enable-openmp",
                        "--with-pic"
                    ],
                    "build-options": {
                        "arch": {
                            "x86_64": {
                                "config-opts": [
                                    "--enable-sse2",
                                    "--enable-avx",
                                    "--enable-avx-128-fma"
                                ]
                            }
                        }
                    },
                    "sources": [
                        {
                            "type": "archive",
                            "url": "http://www.fftw.org/fftw-3.3.7.tar.gz",
                            "sha256": "3b609b7feba5230e8f6dd8d245ddbefac324c5a6ae4186947670d9ac2cd25573"
                        }
                    ],
                    "cleanup": [
                        "/bin",
                        "/include",
                        "/lib/*.la"
                    ]
                }
            ]
        },
        {
            "name": "natron",
            "buildsystem": "qmake",
            "config-opts": [
                "CONFIG+=stable",
                "CONFIG+=enforce-gcc8"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/NatronGitHub/Natron.git",
                    "commit": "513a2491008c152417ae913f8d1ab83e432aa7e3"
                },
                {
                    "type": "patch",
                    "path": "patches/natron_plugins-path.diff"
                },
                {
                    "type": "patch",
                    "path": "patches/natron_fix_path.patch"
                },
                {
                    "type": "patch",
                    "path": "patches/fix_project_mime_icon.patch"
                },
                {
                    "type": "file",
                    "path": "config.pri"
                },
                {
                    "type": "file",
                    "path": "fr.natron.Natron.appdata.xml"
                },
                {
                    "type": "archive",
                    "url": "https://github.com/NatronGitHub/OpenColorIO-Configs/archive/Natron-v3.0.tar.gz",
                    "sha256": "1d760f6a97fa0b44f69bdfe7d8e9949957fe4ccd1389b3059630094649ff249e",
                    "dest": "./OpenColorIO-Configs"
                }
            ],
            "post-install": [
                "mv /app/share/mime/packages/x-natron.xml /app/share/mime/packages/fr.natron.Natron.xml",
                "install -Dm644 -p ./fr.natron.Natron.appdata.xml /app/share/metainfo/fr.natron.Natron.appdata.xml",
                "install -Dm644 ./Gui/Resources/Images/natronIcon256_linux.png /app/share/icons/hicolor/256x256/apps/natronIcon256_linux.png",
                "install -Dm644 ./Gui/Resources/Images/natronIcon.svg /app/share/icons/hicolor/scalable/apps/fr.natron.Natron.svg",
                "install -Dm644 ./Gui/Resources/Images/natronProjectIcon_linux.png /app/share/icons/hicolor/256x256/mimetypes/fr.natron.Natron-project.png",
                "mkdir -p /app/Plugins && cp -r ./Gui/Resources/PyPlugs /app/Plugins/PyPlugs",
                "cp -r /app/lib/python2.7/site-packages/PySide /app/Plugins/PySide",
                "cp -r ./Gui/Resources/etc/ /app"
            ]
        }
    ]
}
